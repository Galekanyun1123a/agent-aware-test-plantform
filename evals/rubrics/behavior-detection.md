# 用户行为检测响应评分标准

## 评估目标

评估 AI Agent 主动读取和响应 `.agent-aware/` 目录下检测文件的能力，包括：
- 用户挫折行为检测（frustration）
- 愤怒点击检测（rage click）
- 死点击检测（dead click）
- 运行时错误检测

## 项目环境要求

基于 System Prompt 中定义的检测机制：
- `.agent-aware/behavior.json` - 行为检测结果
- `.agent-aware/error.json` - 错误检测结果

## 评估维度

### 问题识别能力 (0-1)

评估 AI 识别和理解用户行为问题的能力。

- **1.0 分**:
  - 主动读取 `.agent-aware/` 目录下的检测文件
  - 准确识别问题类型（挫折、愤怒点击、死点击、错误）
  - 正确解析严重程度（critical/warning/info）
  - 理解问题的具体细节（挫折指数、点击次数等）

- **0.7 分**: 能识别主要问题，但细节理解不够准确

- **0.5 分**: 读取了文件但分析不够深入

- **0.3 分**: 只能识别部分问题

- **0.0 分**: 未能读取或识别任何问题

### 原因分析能力 (0-1)

评估 AI 分析问题根本原因的能力。

- **1.0 分**:
  - 准确分析问题产生的原因
  - 结合代码和用户行为数据进行关联分析
  - 识别出可能导致用户困扰的 UI 元素
  - 考虑了用户体验因素

- **0.7 分**: 分析基本准确，但不够全面

- **0.5 分**: 给出了一些可能原因，但不够具体

- **0.3 分**: 分析过于表面或有明显遗漏

- **0.0 分**: 未进行分析或分析完全错误

### 修复方案质量 (0-1)

评估 AI 提出的修复方案的质量。

- **1.0 分**:
  - 方案直接针对检测到的问题
  - 修复代码正确且可执行
  - 考虑了用户体验改进
  - 不会引入新问题

- **0.7 分**: 方案基本可行，但有小改进空间

- **0.5 分**: 方案能部分解决问题

- **0.3 分**: 方案有明显缺陷

- **0.0 分**: 未提供方案或方案不可行

### 主动响应程度 (0-1)

评估 AI 主动发现和响应问题的程度。

- **1.0 分**:
  - 主动读取检测文件，无需用户提示
  - 主动提出修复建议
  - 主动实施修复并验证效果
  - 主动询问是否需要进一步优化

- **0.7 分**: 能主动读取并响应，但需要适当引导

- **0.5 分**: 需要用户明确指示才会读取检测文件

- **0.3 分**: 只在被要求时才查看问题

- **0.0 分**: 完全被动，不会主动发现问题

## 检测文件格式说明

### behavior.json（行为检测）

```json
{
  "timestamp": "2026-01-30T10:30:00.000Z",
  "severity": "critical",
  "type": "frustration",
  "summary": "检测到用户挫折行为（挫折指数: 75）",
  "details": {
    "frustrationScore": 75,
    "rageClickCount": 5,
    "deadClickCount": 3,
    "totalInteractions": 20,
    "recentActions": [
      {"type": "rage_click", "target": "button.submit", "count": 5},
      {"type": "dead_click", "target": "div.disabled-area", "count": 3}
    ],
    "possibleCauses": [
      "提交按钮无响应",
      "链接不可点击"
    ]
  }
}
```

### error.json（错误检测）

```json
{
  "timestamp": "2026-01-30T10:30:00.000Z",
  "severity": "critical",
  "type": "error",
  "summary": "检测到 3 个运行时错误",
  "details": {
    "totalErrors": 3,
    "errorTypes": ["runtime", "promise"],
    "recentErrors": [
      {
        "message": "Cannot read property 'foo' of undefined",
        "stack": "...",
        "timestamp": "2026-01-30T10:29:55.000Z"
      }
    ]
  }
}
```

## 检测触发条件

### BehaviorDetector（行为检测器）

| 严重程度 | 触发条件 |
|---------|---------|
| Critical | 挫折指数 >= 70 |
| Warning | 挫折指数 50-70，或愤怒点击 >= 3 次，或死点击 >= 2 次 |
| Info | 有轻微用户困扰迹象 |

### AlertDetector（错误检测器）

| 严重程度 | 触发条件 |
|---------|---------|
| Critical | 错误数 >= 1 |
| Warning | 控制台警告较多 |

## 示例评估

### 满分响应示例

对于以下检测数据：
```json
{
  "severity": "critical",
  "type": "frustration",
  "details": {
    "frustrationScore": 85,
    "rageClickCount": 7,
    "deadClickCount": 4
  }
}
```

满分响应：
```
我检测到 `.agent-aware/behavior.json` 中有严重的用户挫折行为：

## 问题分析
1. **挫折指数高达 85 分**（严重级别 >= 70）
2. **愤怒点击 7 次** - 用户在同一元素上快速重复点击
3. **死点击 4 次** - 用户点击了无响应的元素

## 可能原因
- 提交按钮可能没有绑定点击事件
- 某些区域看起来可点击但实际无响应
- 页面响应速度慢导致用户反复点击

## 修复方案

我来检查相关代码并修复：

1. 为提交按钮添加正确的事件处理
2. 添加点击反馈（如 loading 状态）
3. 移除或修改看起来可点击但无功能的元素

[然后提供具体的代码修复]
```

## 评分注意事项

1. **主动性很重要**：AI 应该主动读取检测文件，而不是等待用户指示
2. **分析要具体**：不能只说"有问题"，要具体说明是什么问题
3. **修复要可行**：提供的代码修复应该是可以直接应用的
4. **关注用户体验**：最终目标是改善用户体验，而不只是消除检测警告
5. **评估产出而非过程**：关注 AI 是否解决了问题，而不是使用了什么工具
